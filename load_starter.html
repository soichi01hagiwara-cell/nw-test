<!DOCTYPE html>
<html>
<head>
    <title>Wi-Fi負荷試験スタート</title>
    <meta charset="UTF-8">
</head>
<body>

    <h1>Wi-Fi負荷試験を開始します</h1>
    <p>このボタンを押すと、自動的に複数のダウンロードが開始されます。</p>
    <p>ブラウザの動作が重くなる場合がありますが、画面を閉じずにしばらくお待ちください。</p>

    <button id="startButton" onclick="startLoadTest()">
        試験開始！ (ダウンロードを3回開始します)
    </button>
    
    <div id="status"></div>
    <div id="iframeContainer"></div>

    <script>
        // 設定パラメータ
        const TARGET_URL = "https://s01prefshizuoka.github.io/nw-test/testfile.zip";
        const NUM_DOWNLOADS = 3; // ★ 1台のChromebookで同時に開始するダウンロード数
        // -----------------------------------------------------------------------

        function startLoadTest() {
            const statusDiv = document.getElementById('status');
            const container = document.getElementById('iframeContainer');
            const startButton = document.getElementById('startButton');

            // ボタンとステータスの更新
            startButton.disabled = true;
            statusDiv.innerHTML = "<h2>試験実行中... ダウンロードが開始するまでお待ちください。</h2>";
            
            // iFrame生成で複数のダウンロードを強制的に開始
            for (let i = 0; i < NUM_DOWNLOADS; i++) {
                const iframe = document.createElement('iframe');
                // iframeを非表示にして、画面には表示しない
                iframe.style.display = 'none'; 
                // ダウンロードURLをiframeのソースに設定
                iframe.src = TARGET_URL; 
                // ボディに追加してダウンロードをトリガー
                container.appendChild(iframe);
            }
            
            statusDiv.innerHTML += `<p>✅ ${NUM_DOWNLOADS} 個のダウンロードが開始されました。</p>`;
            alert(`${NUM_DOWNLOADS} 個のダウンロードを開始しました。画面を閉じずに待機してください。`);
        }
    </script>

</body>
</html>

